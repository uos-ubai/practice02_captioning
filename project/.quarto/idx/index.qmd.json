{"title":"Image Captioning","markdown":{"yaml":{"title":"Image Captioning","engine":"knitr"},"headingText":"1. ê²½ë¡œ ë° í™˜ê²½ ì„¤ì •","headingAttr":{"id":"","classes":["unnumbered"],"keyvalue":[]},"containsRefs":false,"markdown":"\n\nPython í”„ë¡œì íŠ¸ì˜ ì¼í™˜ìœ¼ë¡œ, ì´ë¯¸ì§€ ìº¡ì…”ë‹(Image Captioning) í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\nì´ë¯¸ì§€ ìº¡ì…”ë‹ì´ë€, ì£¼ì–´ì§„ ì´ë¯¸ì§€ë¥¼ ì„¤ëª…í•˜ëŠ” ë¬¸ì¥ì„ ë§Œë“¤ì–´ë‚´ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. \n\nì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ì™€ ê°™ì€ ì´ë¯¸ì§€ê°€ ëª¨ë¸ì— ì…ë ¥ë˜ê²Œ ë˜ë©´, ëª¨ë¸ì€ â€œA black dog sitting among leaves in a forest, surrounded by trees.(ê²€ì€ ê°œê°€ ìˆ² ì† ë‚˜ë¬´ë“¤ ì‚¬ì´ì—ì„œ ë‚˜ë­‡ìì— ë‘˜ëŸ¬ì‹¸ì—¬ ì•‰ì•„ ìˆëŠ” ëª¨ìŠµ.)â€ì´ë¼ëŠ” ìº¡ì…˜ì´ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤.\n\n![](./jpg/dog.jpg)\n\nì´ëŸ¬í•œ ìº¡ì…”ë‹ ëª¨ë¸ì„ í•™ìŠµí•˜ê¸° ìœ„í•œ ì‹¤ìŠµì„ ì‹œì‘í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\n\n</br>\n\n\ní”„ë¡œì íŠ¸ ìˆ˜í–‰ì— ì•ì„œ, í•­ìƒ ì£¼ì˜í•´ì•¼ í•  ë¶€ë¶„ì€ ê²½ë¡œì™€ í™˜ê²½ì…ë‹ˆë‹¤.\n\n### ê²½ë¡œ ì„¤ì • {.unnumbered}\në¨¼ì € ì„ì˜ì˜ í”„ë¡œì íŠ¸ í´ë”ë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤. ì €ëŠ” captioning ì´ë¼ëŠ” í´ë”ë¥¼ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤.\nTerminalì—ì„œë„ í•´ë‹¹ ê²½ë¡œì—ì„œ ì‘ì—…í•œë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ê¸° ìœ„í•´, cd ëª…ë ¹ì–´ë¥¼ í†µí•´ ì‘ì—… í´ë”(captioning í´ë”)ë¡œ ì§„ì…í•˜ê² ìŠµë‹ˆë‹¤.\n\n</br>\n\nğŸ“Œ **ì°¸ê³ ì‚¬í•­**\n\nëª…ë ¹ì–´ `pwd`ëŠ” í˜„ì¬ ì‘ì—… ê²½ë¡œë¥¼ í™•ì¸í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.\n\nëª…ë ¹ì–´ `cd`ëŠ” ì´ë™í•˜ê³ ìí•˜ëŠ” ì‘ì—… ê²½ë¡œë¥¼ ì§€ì •í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.\n\n\n![](./jpg/cd.jpg)\n\n### í™˜ê²½ ì„¤ì • {.unnumbered}\në‹¤ìŒ í”„ë¡œì íŠ¸ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ê°€ìƒí™˜ê²½ì„ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n(1) enroot ê°€ìƒí™˜ê²½\n\nê°€ìƒí™˜ê²½ì„ ìƒì„±í•˜ê³  í™œìš©í•˜ëŠ” ë°ì—ëŠ” ì—¬ëŸ¬ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ ì¤‘ enrootë¥¼ í™œìš©í•˜ì—¬ ë²„ì „ í˜¸í™˜ì´ ì´ë£¨ì–´ì§„ ê°€ìƒí™˜ê²½ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì„ ê°€ì¥ ë¨¼ì € ì†Œê°œí•©ë‹ˆë‹¤.\n\nê³„ì‚° ë…¸ë“œì— ì§„ì…í•˜ì—¬ í•„ìš”í•œ í”„ë ˆì„ì›Œí¬ì™€ OS ë²„ì „ì„ ë§ì¶° enrootë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.\n\nì´í›„ ê³„ì‚°ì— í•„ìš”í•œ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë°›ê³  ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.\n        \n```{bash}\n#| eval: false\n\n# gpu5 íŒŒí‹°ì…˜ ë…¸ë“œì— ì§„ì…\nsrun --pty -p gpu5 -c 2 /bin/bash\n\n# dockerhubì—ì„œ ì›í•˜ëŠ” ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ\nenroot import docker://eclipse/ubuntu_python\n\n# ë‹¤ìš´ë¡œë“œëœ ì´ë¯¸ì§€ ubuntu.sqshë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë§Œë“¦\nenroot create -n mycontainer eclipse_ubuntu_python.sqsh\n\n# ì»¨í…Œì´ë„ˆ í™˜ê²½ì— ì§„ì…\nenroot start --root --rw --mount .:/mnt ubuntu-test /bin/bash\n```\n    \n\n\n(2) conda ê°€ìƒí™˜ê²½\n\nì´ ì™¸ì—ë„ condaë¥¼ í†µí•´ ê°€ìƒí™˜ê²½ì„ ìƒì„±í•˜ì—¬ í™œìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n`conda create -n captioning python=3.8` ëª…ë ¹ì–´ë¥¼ í†µí•´ python ë²„ì „ 3.8ì„ ê°€ì§„ captioning ì´ë¼ëŠ” ì´ë¦„ì˜ ê°€ìƒí™˜ê²½ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\nì´í›„ `conda activate captioning`ìœ¼ë¡œ ê°€ìƒí™˜ê²½ì— ì§„ì…í•©ë‹ˆë‹¤.\n\n![](./jpg/env.jpg)\n\n\n</br>\n\n`pip install -r requirements.txt` ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ìš´ë°›ê² ìŠµë‹ˆë‹¤. requirementsëŠ” enrootì™€ conda ë‘˜ ë‹¤ í•„ìš”í•œ ì‘ì—…ì…ë‹ˆë‹¤.\n\nğŸ’¡ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ìš´ë°›ì„ ë•Œì—ëŠ” OSì™€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“± ê°„ì˜ ë²„ì „ í˜¸í™˜ì— ë°˜ë“œì‹œ ìœ ì˜í•˜ì„¸ìš”! ë²„ì „ í˜¸í™˜ì´ ë˜ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!\n\n```{bash}\n#| eval: false\n\n# requirements.txt\n\ntorch==1.13.1+cu118\ntorchvision==0.14.1+cu118\ntransformers==4.24.0\nmatplotlib==3.5.3\njupyter==1.0.0\n\n```\n\n</br>\n\n## 2. ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ {.unnumbered}\n\nìº¡ì…”ë‹ ëª¨ë¸ì„ í•™ìŠµí•˜ê¸° ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì…‹ì€ ë§¤ìš° ë§ìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ê·¸ ì¤‘ **Microsoft COCO (ì´í•˜ MS COCO)** ë°ì´í„°ì…‹ì„ í™œìš©í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\n\nMS COCOëŠ” Object detection(ë¬¼ì²´ íƒì§€), Segmentation(ë¶„ë¥˜), Captioningì— ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ, ì»´í“¨í„° ë¹„ì „ ë¶„ì•¼ì—ì„œ ë„“ì€ í­ìœ¼ë¡œ ì‚¬ìš©ë˜ê³  ìˆëŠ” ë°ì´í„°ì…‹ì…ë‹ˆë‹¤.\n\nMS COCO ë°ì´í„°ì…‹ ë‹¤ìš´ë°›ê¸° ìœ„í•œ shell ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n```{bash}\n#| eval: false\n\n#!/bin/bash\n\n# COCO dataset directory\nmkdir -p /data/coco\n\n# Download COCO Train2014 images and captions\ncd /data/coco\nwget http://images.cocodataset.org/zips/train2014.zip\nwget http://images.cocodataset.org/zips/val2014.zip\nwget http://images.cocodataset.org/annotations/annotations_trainval2014.zip\n\n# Unzip the dataset\nunzip train2014.zip\nunzip val2014.zip\nunzip annotations_trainval2014.zip\n```\n\nâœ” `mkdir` ëª…ë ¹ì–´ë¥¼ í†µí•´ dataë¥¼ ì €ì¥í•˜ê³ ì í•˜ëŠ” ê²½ë¡œë¥¼ ëª…ì‹œí•´ì£¼ì„¸ìš”. mkdirëŠ” í•´ë‹¹ ê²½ë¡œë¥¼ ìƒì„±í•´ì£¼ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.\n\nâœ” `cd` ëª…ë ¹ì–´ë¥¼ í†µí•´ ìƒì„±í•œ ê²½ë¡œë¡œ ì§„ì…í•©ë‹ˆë‹¤.\n\nâœ” `wget` ëª…ë ¹ì–´ë¥¼ í†µí•´ MS COCO datasetì„ ì €ì¥í•  ìˆ˜ ìˆëŠ” ì¸í„°ë„· ì‚¬ì´íŠ¸ë¡œ ì ‘ì†í•˜ì—¬, íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤.\n\nâœ” `unzip` ëª…ë ¹ì–´ë¥¼ í†µí•´ ì €ì¥í•œ datasetì˜ zipíŒŒì¼ì„ ì••ì¶•í•´ì œí•˜ì—¬, ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ ë‘¡ë‹ˆë‹¤.\n\n\níŒŒì¼ ì‘ì„±ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì´ì œ shell ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì‹¤í–‰í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\n\n![](./jpg/shell_error.jpg)\n\në°”ë¡œ `datset_download.sh` ëª…ë ¹ì–´ë¥¼ í†µí•´ shell íŒŒì¼ì„ ì‹¤í–‰í•˜ë‹¤ë³´ë©´, \"permission denied (ê¶Œí•œ ì˜¤ë¥˜)\"ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒŒì¼ ì‹¤í–‰ ê¶Œí•œì„ ê°€ì§€ê¸° ìœ„í•´, `chmod` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\n\n`chmod` ëª…ë ¹ì–´ëŠ” íŒŒì¼ì˜ ê¶Œí•œì„ ë°”ê¿”ì£¼ëŠ” ë¦¬ëˆ…ìŠ¤ ëª…ë ¹ì–´ë¡œ, ëª…ë ¹ì–´ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n```{bash}\n#| eval: false\n\nchmod [references][operator][modes] file1 ...\n```\n\n| operator | role           |\n|----------|----------------|\n| r        | ì½ê¸°(read)     |\n| w        | ì“°ê¸°(write)    |\n| x        | ì‹¤í–‰(execute)  |\n\n\n\nìš°ë¦¬ê°€ ì‹¤í–‰í•œ ëª…ë ¹ì–´ `chmod +x [file_name.sh]`ëŠ” +xë¥¼ í†µí•´ ì‹¤í–‰í•˜ëŠ” ê¶Œí•œì„ [file_name.sh]ì— ë¶€ì—¬í•œ ê²ƒì…ë‹ˆë‹¤.\n\n![](./jpg/shell_error.jpg)\n\níŒŒì¼ ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nëª¨ë“  íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œ ë˜ì—ˆë‹¤ë©´, ë°˜ë“œì‹œ ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ ë˜ì—ˆëŠ”ì§€ í´ë” ë‚´ ê²½ë¡œë¡œ ì§„ì…í•˜ì—¬ í™•ì¸í•˜ì„¸ìš”.\n\n![](./jpg/coco_download.jpg)\n\n</br>\n\n## 3. íŒŒì´ì¬ í”„ë¡œì íŠ¸ ì‹¤í–‰ {.unnumbered}\n\nëª¨ë¸ì„ í•™ìŠµì‹œí‚¬ ë°ì´í„°ì…‹ì„ ë‹¤ìš´ë°›ì•˜ìœ¼ë‹ˆ, ì´ì œ í•™ìŠµí•  ëª¨ë¸ì„ ì§€ì •í•´ì£¼ê² ìŠµë‹ˆë‹¤.\n\nì—¬ê¸°ì„œëŠ” **Transformer** ëª¨ë¸ì„ í•™ìŠµì‹œí‚µë‹ˆë‹¤. TransformerëŠ” 2017ë…„ Googleì—ì„œ ë°œí‘œëœ ì´í›„ë¡œ ë”¥ëŸ¬ë‹ ì „ì—­ì—ì„œ í™œë°œí•˜ê²Œ ì‚¬ìš©ë˜ê³  ìˆëŠ” ëª¨ë¸ë¡œ, ìº¡ì…”ë‹ì„ í•™ìŠµí•˜ê¸°ì—ë„ ìœ ìš©í•œ ëª¨ë¸ì…ë‹ˆë‹¤.\n\nì „ì²´ ì½”ë“œëŠ” [transformer.py](transformer.qmd) íŒŒì¼ì„ ì°¸ê³ í•˜ì‹œê¸° ë°”ë¼ë©°, [ë§í¬](https://github.com/uos-ubai/practice02_captioning/blob/main/image_captioning.ipynb)ë¥¼ í†µí•´ ì‘ì„±í•œ transformer.py íŒŒì¼ì˜ ì„¸ë¶€ ì½”ë“œ ë° ì„¤ëª…ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ íŒŒì´ì¬ í”„ë¡œì íŠ¸ëŠ” slurmì„ í†µí•´ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´, HPC í™˜ê²½ì—ì„œ ëª¨ë¸ì„ í•™ìŠµí•˜ê¸° ìœ„í•œ slurm ìŠ¤í¬ë¦½íŠ¸ `transformer.sh`ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.\n\n</br>\n\nìŠ¤í¬ë¦½íŠ¸ ì‘ì„±ì€ 2ê°€ì§€ ë²„ì „ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ì†Œê°œí•©ë‹ˆë‹¤.\nê³„ì‚° ë…¸ë“œì— ì§„ì…í•œ í›„, enroot ê°€ìƒí™˜ê²½ì„ ì‚¬ìš©í•˜ì˜€ë‹¤ë©´ SLURM ì‘ì—… ìŠ¤ì¼€ì¥´ëŸ¬ë¥¼ í†µí•œ ìë™í™” ë°°ì¹˜ ì‘ì—…ì´ í•„ìš”í•˜ì§€ ì•Šê¸°ì—, í•„ìš”í•œ í™˜ê²½ê³¼ ëª¨ë“ˆë§Œ ë¡œë“œí•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\n```{bash}\n#| eval: false\n\necho \"start at:\" `date` # ì ‘ì†í•œ ë‚ ì§œ í‘œê¸°\necho \"node: $HOSTNAME\" # ì ‘ì†í•œ ë…¸ë“œ ë²ˆí˜¸ í‘œê¸°\necho \"jobid: $SLURM_JOB_ID\" # jobid í‘œê¸°\n\n# Load modules\nmodule load cuda/11.8\n\n# Train the transformer-based image captioning model\npython transformer.py\n```\n\ncondaë¥¼ í†µí•´ ê°€ìƒí™˜ê²½ ì‹¤í–‰ì‹œì¼°ë‹¤ë©´, ë…¸ë“œ ì§„ì…ì„ ìœ„í•œ ì…‹íŒ…ì´ ì¶”ê°€ë¡œ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— SBATCHë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.\n\n```{bash}\n#| eval: false\n\n#!/bin/bash\n#SBATCH --job-name=captioning\n#SBATCH --output=./output/training_captioning_%n_%j.out\n#SBATCH --error=./output/training_captioning_%n_%j.err\n#SBATCH --nodes=2\n#SBATCH --partition=gpu3\n#SBATCH --gres=gpu:4\n#SBATCH --cpus-per-task=16\n#SBATCH --mem=128G\n#SBATCH --time=24:00:00\n\necho \"start at:\" `date` # ì ‘ì†í•œ ë‚ ì§œ í‘œê¸°\necho \"node: $HOSTNAME\" # ì ‘ì†í•œ ë…¸ë“œ ë²ˆí˜¸ í‘œê¸°\necho \"jobid: $SLURM_JOB_ID\" # jobid í‘œê¸°\n\n# Load modules\nmodule load cuda/11.8\n\n# Train the transformer-based image captioning model\npython transformer.py\n```\n\nâœ” **`#SBATCH --job-name=captioning`**\njob-nameì„ captioningìœ¼ë¡œ ì§€ì •í•˜ì˜€ìŠµë‹ˆë‹¤.\n\nâœ” output íŒŒì¼ê³¼ error íŒŒì¼ì€ output í´ë”ì˜ training_captioningì´ë¼ëŠ” íŒŒì¼ëª…ìœ¼ë¡œ ì§€ì •í•˜ì˜€ìŠµë‹ˆë‹¤.\n\nâœ” **`#SBATCH --nodes=2`**\në³µì¡í•œ ì‘ì—…ì„ ìš”êµ¬í•˜ëŠ” í”„ë¡œì íŠ¸ì¸ ë§Œí¼, ì‹œê°„ì˜ íš¨ìœ¨ì„±ì„ ìœ„í•´ node 2ê°œë¥¼ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤. ì´ì— ë”°ë¼, node 2ê°œë¡œ í•˜ë‚˜ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë³‘ë ¬ ì»´í“¨íŒ…ì„ ì‹œí–‰í•©ë‹ˆë‹¤.\n\nâœ” **`#SBATCH --gres=gpu:4`**\ngpuëŠ” 4ëŒ€ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.\n\nâœ” **`module load cuda/11.8`**\nmoduleì€ cuda 11.8 versionì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.\n\nâœ” **`python transformer.py`**\n`transformer.py` íŒŒì¼ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\n`sbatch transformer.sh`ë¥¼ í†µí•´ ì‘ì—…(job)ì„ í• ë‹¹í•˜ì˜€ìŠµë‹ˆë‹¤.\n\ní”„ë¡œì íŠ¸ì—ì„œ tqdm ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ì§„ì²™ë„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆê²Œ ì„¸íŒ…í•´ë‘ ì— ë”°ë¼, error íŒŒì¼ì—ì„œ ì§„ì²™ë„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![](./jpg/epoch.jpg)\n\nout íŒŒì¼ì—ì„œ í•™ìŠµëœ logë¥¼ í†µí•´, ì‹¤í–‰ ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.\n\nì•„ë˜ì˜ ê·¸ë¦¼ì— ëŒ€í•´ \"a shoe rack with some shoes and a dog sleeping on them\"ê³¼ ê°™ì€ captionì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![](./jpg/COCO_val2014_000000000042.jpg)\n\n</br>\n\nì´ìƒìœ¼ë¡œ Captioning í”„ë¡œì íŠ¸ ì‹¤ìŠµì„ ì¢…ë£Œí•©ë‹ˆë‹¤.","srcMarkdownNoYaml":"\n\nPython í”„ë¡œì íŠ¸ì˜ ì¼í™˜ìœ¼ë¡œ, ì´ë¯¸ì§€ ìº¡ì…”ë‹(Image Captioning) í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.\n\nì´ë¯¸ì§€ ìº¡ì…”ë‹ì´ë€, ì£¼ì–´ì§„ ì´ë¯¸ì§€ë¥¼ ì„¤ëª…í•˜ëŠ” ë¬¸ì¥ì„ ë§Œë“¤ì–´ë‚´ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. \n\nì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ì™€ ê°™ì€ ì´ë¯¸ì§€ê°€ ëª¨ë¸ì— ì…ë ¥ë˜ê²Œ ë˜ë©´, ëª¨ë¸ì€ â€œA black dog sitting among leaves in a forest, surrounded by trees.(ê²€ì€ ê°œê°€ ìˆ² ì† ë‚˜ë¬´ë“¤ ì‚¬ì´ì—ì„œ ë‚˜ë­‡ìì— ë‘˜ëŸ¬ì‹¸ì—¬ ì•‰ì•„ ìˆëŠ” ëª¨ìŠµ.)â€ì´ë¼ëŠ” ìº¡ì…˜ì´ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤.\n\n![](./jpg/dog.jpg)\n\nì´ëŸ¬í•œ ìº¡ì…”ë‹ ëª¨ë¸ì„ í•™ìŠµí•˜ê¸° ìœ„í•œ ì‹¤ìŠµì„ ì‹œì‘í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\n\n</br>\n\n## 1. ê²½ë¡œ ë° í™˜ê²½ ì„¤ì • {.unnumbered}\n\ní”„ë¡œì íŠ¸ ìˆ˜í–‰ì— ì•ì„œ, í•­ìƒ ì£¼ì˜í•´ì•¼ í•  ë¶€ë¶„ì€ ê²½ë¡œì™€ í™˜ê²½ì…ë‹ˆë‹¤.\n\n### ê²½ë¡œ ì„¤ì • {.unnumbered}\në¨¼ì € ì„ì˜ì˜ í”„ë¡œì íŠ¸ í´ë”ë¥¼ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤. ì €ëŠ” captioning ì´ë¼ëŠ” í´ë”ë¥¼ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤.\nTerminalì—ì„œë„ í•´ë‹¹ ê²½ë¡œì—ì„œ ì‘ì—…í•œë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ê¸° ìœ„í•´, cd ëª…ë ¹ì–´ë¥¼ í†µí•´ ì‘ì—… í´ë”(captioning í´ë”)ë¡œ ì§„ì…í•˜ê² ìŠµë‹ˆë‹¤.\n\n</br>\n\nğŸ“Œ **ì°¸ê³ ì‚¬í•­**\n\nëª…ë ¹ì–´ `pwd`ëŠ” í˜„ì¬ ì‘ì—… ê²½ë¡œë¥¼ í™•ì¸í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.\n\nëª…ë ¹ì–´ `cd`ëŠ” ì´ë™í•˜ê³ ìí•˜ëŠ” ì‘ì—… ê²½ë¡œë¥¼ ì§€ì •í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.\n\n\n![](./jpg/cd.jpg)\n\n### í™˜ê²½ ì„¤ì • {.unnumbered}\në‹¤ìŒ í”„ë¡œì íŠ¸ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ê°€ìƒí™˜ê²½ì„ ìƒì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n(1) enroot ê°€ìƒí™˜ê²½\n\nê°€ìƒí™˜ê²½ì„ ìƒì„±í•˜ê³  í™œìš©í•˜ëŠ” ë°ì—ëŠ” ì—¬ëŸ¬ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ ì¤‘ enrootë¥¼ í™œìš©í•˜ì—¬ ë²„ì „ í˜¸í™˜ì´ ì´ë£¨ì–´ì§„ ê°€ìƒí™˜ê²½ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì„ ê°€ì¥ ë¨¼ì € ì†Œê°œí•©ë‹ˆë‹¤.\n\nê³„ì‚° ë…¸ë“œì— ì§„ì…í•˜ì—¬ í•„ìš”í•œ í”„ë ˆì„ì›Œí¬ì™€ OS ë²„ì „ì„ ë§ì¶° enrootë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.\n\nì´í›„ ê³„ì‚°ì— í•„ìš”í•œ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë°›ê³  ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.\n        \n```{bash}\n#| eval: false\n\n# gpu5 íŒŒí‹°ì…˜ ë…¸ë“œì— ì§„ì…\nsrun --pty -p gpu5 -c 2 /bin/bash\n\n# dockerhubì—ì„œ ì›í•˜ëŠ” ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œ\nenroot import docker://eclipse/ubuntu_python\n\n# ë‹¤ìš´ë¡œë“œëœ ì´ë¯¸ì§€ ubuntu.sqshë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë§Œë“¦\nenroot create -n mycontainer eclipse_ubuntu_python.sqsh\n\n# ì»¨í…Œì´ë„ˆ í™˜ê²½ì— ì§„ì…\nenroot start --root --rw --mount .:/mnt ubuntu-test /bin/bash\n```\n    \n\n\n(2) conda ê°€ìƒí™˜ê²½\n\nì´ ì™¸ì—ë„ condaë¥¼ í†µí•´ ê°€ìƒí™˜ê²½ì„ ìƒì„±í•˜ì—¬ í™œìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n`conda create -n captioning python=3.8` ëª…ë ¹ì–´ë¥¼ í†µí•´ python ë²„ì „ 3.8ì„ ê°€ì§„ captioning ì´ë¼ëŠ” ì´ë¦„ì˜ ê°€ìƒí™˜ê²½ì„ ìƒì„±í•©ë‹ˆë‹¤.\n\nì´í›„ `conda activate captioning`ìœ¼ë¡œ ê°€ìƒí™˜ê²½ì— ì§„ì…í•©ë‹ˆë‹¤.\n\n![](./jpg/env.jpg)\n\n\n</br>\n\n`pip install -r requirements.txt` ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ìš´ë°›ê² ìŠµë‹ˆë‹¤. requirementsëŠ” enrootì™€ conda ë‘˜ ë‹¤ í•„ìš”í•œ ì‘ì—…ì…ë‹ˆë‹¤.\n\nğŸ’¡ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ìš´ë°›ì„ ë•Œì—ëŠ” OSì™€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“± ê°„ì˜ ë²„ì „ í˜¸í™˜ì— ë°˜ë“œì‹œ ìœ ì˜í•˜ì„¸ìš”! ë²„ì „ í˜¸í™˜ì´ ë˜ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!\n\n```{bash}\n#| eval: false\n\n# requirements.txt\n\ntorch==1.13.1+cu118\ntorchvision==0.14.1+cu118\ntransformers==4.24.0\nmatplotlib==3.5.3\njupyter==1.0.0\n\n```\n\n</br>\n\n## 2. ë°ì´í„°ì…‹ ë‹¤ìš´ë¡œë“œ {.unnumbered}\n\nìº¡ì…”ë‹ ëª¨ë¸ì„ í•™ìŠµí•˜ê¸° ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì…‹ì€ ë§¤ìš° ë§ìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ê·¸ ì¤‘ **Microsoft COCO (ì´í•˜ MS COCO)** ë°ì´í„°ì…‹ì„ í™œìš©í•´ë³´ê³ ì í•©ë‹ˆë‹¤.\n\nMS COCOëŠ” Object detection(ë¬¼ì²´ íƒì§€), Segmentation(ë¶„ë¥˜), Captioningì— ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì…‹ìœ¼ë¡œ, ì»´í“¨í„° ë¹„ì „ ë¶„ì•¼ì—ì„œ ë„“ì€ í­ìœ¼ë¡œ ì‚¬ìš©ë˜ê³  ìˆëŠ” ë°ì´í„°ì…‹ì…ë‹ˆë‹¤.\n\nMS COCO ë°ì´í„°ì…‹ ë‹¤ìš´ë°›ê¸° ìœ„í•œ shell ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì‘ì„±í•˜ê² ìŠµë‹ˆë‹¤.\n\n```{bash}\n#| eval: false\n\n#!/bin/bash\n\n# COCO dataset directory\nmkdir -p /data/coco\n\n# Download COCO Train2014 images and captions\ncd /data/coco\nwget http://images.cocodataset.org/zips/train2014.zip\nwget http://images.cocodataset.org/zips/val2014.zip\nwget http://images.cocodataset.org/annotations/annotations_trainval2014.zip\n\n# Unzip the dataset\nunzip train2014.zip\nunzip val2014.zip\nunzip annotations_trainval2014.zip\n```\n\nâœ” `mkdir` ëª…ë ¹ì–´ë¥¼ í†µí•´ dataë¥¼ ì €ì¥í•˜ê³ ì í•˜ëŠ” ê²½ë¡œë¥¼ ëª…ì‹œí•´ì£¼ì„¸ìš”. mkdirëŠ” í•´ë‹¹ ê²½ë¡œë¥¼ ìƒì„±í•´ì£¼ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.\n\nâœ” `cd` ëª…ë ¹ì–´ë¥¼ í†µí•´ ìƒì„±í•œ ê²½ë¡œë¡œ ì§„ì…í•©ë‹ˆë‹¤.\n\nâœ” `wget` ëª…ë ¹ì–´ë¥¼ í†µí•´ MS COCO datasetì„ ì €ì¥í•  ìˆ˜ ìˆëŠ” ì¸í„°ë„· ì‚¬ì´íŠ¸ë¡œ ì ‘ì†í•˜ì—¬, íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤.\n\nâœ” `unzip` ëª…ë ¹ì–´ë¥¼ í†µí•´ ì €ì¥í•œ datasetì˜ zipíŒŒì¼ì„ ì••ì¶•í•´ì œí•˜ì—¬, ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í˜•íƒœë¡œ ë‘¡ë‹ˆë‹¤.\n\n\níŒŒì¼ ì‘ì„±ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, ì´ì œ shell ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì‹¤í–‰í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.\n\n![](./jpg/shell_error.jpg)\n\në°”ë¡œ `datset_download.sh` ëª…ë ¹ì–´ë¥¼ í†µí•´ shell íŒŒì¼ì„ ì‹¤í–‰í•˜ë‹¤ë³´ë©´, \"permission denied (ê¶Œí•œ ì˜¤ë¥˜)\"ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒŒì¼ ì‹¤í–‰ ê¶Œí•œì„ ê°€ì§€ê¸° ìœ„í•´, `chmod` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\n\n`chmod` ëª…ë ¹ì–´ëŠ” íŒŒì¼ì˜ ê¶Œí•œì„ ë°”ê¿”ì£¼ëŠ” ë¦¬ëˆ…ìŠ¤ ëª…ë ¹ì–´ë¡œ, ëª…ë ¹ì–´ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n\n```{bash}\n#| eval: false\n\nchmod [references][operator][modes] file1 ...\n```\n\n| operator | role           |\n|----------|----------------|\n| r        | ì½ê¸°(read)     |\n| w        | ì“°ê¸°(write)    |\n| x        | ì‹¤í–‰(execute)  |\n\n\n\nìš°ë¦¬ê°€ ì‹¤í–‰í•œ ëª…ë ¹ì–´ `chmod +x [file_name.sh]`ëŠ” +xë¥¼ í†µí•´ ì‹¤í–‰í•˜ëŠ” ê¶Œí•œì„ [file_name.sh]ì— ë¶€ì—¬í•œ ê²ƒì…ë‹ˆë‹¤.\n\n![](./jpg/shell_error.jpg)\n\níŒŒì¼ ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.\n\nëª¨ë“  íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œ ë˜ì—ˆë‹¤ë©´, ë°˜ë“œì‹œ ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ ë˜ì—ˆëŠ”ì§€ í´ë” ë‚´ ê²½ë¡œë¡œ ì§„ì…í•˜ì—¬ í™•ì¸í•˜ì„¸ìš”.\n\n![](./jpg/coco_download.jpg)\n\n</br>\n\n## 3. íŒŒì´ì¬ í”„ë¡œì íŠ¸ ì‹¤í–‰ {.unnumbered}\n\nëª¨ë¸ì„ í•™ìŠµì‹œí‚¬ ë°ì´í„°ì…‹ì„ ë‹¤ìš´ë°›ì•˜ìœ¼ë‹ˆ, ì´ì œ í•™ìŠµí•  ëª¨ë¸ì„ ì§€ì •í•´ì£¼ê² ìŠµë‹ˆë‹¤.\n\nì—¬ê¸°ì„œëŠ” **Transformer** ëª¨ë¸ì„ í•™ìŠµì‹œí‚µë‹ˆë‹¤. TransformerëŠ” 2017ë…„ Googleì—ì„œ ë°œí‘œëœ ì´í›„ë¡œ ë”¥ëŸ¬ë‹ ì „ì—­ì—ì„œ í™œë°œí•˜ê²Œ ì‚¬ìš©ë˜ê³  ìˆëŠ” ëª¨ë¸ë¡œ, ìº¡ì…”ë‹ì„ í•™ìŠµí•˜ê¸°ì—ë„ ìœ ìš©í•œ ëª¨ë¸ì…ë‹ˆë‹¤.\n\nì „ì²´ ì½”ë“œëŠ” [transformer.py](transformer.qmd) íŒŒì¼ì„ ì°¸ê³ í•˜ì‹œê¸° ë°”ë¼ë©°, [ë§í¬](https://github.com/uos-ubai/practice02_captioning/blob/main/image_captioning.ipynb)ë¥¼ í†µí•´ ì‘ì„±í•œ transformer.py íŒŒì¼ì˜ ì„¸ë¶€ ì½”ë“œ ë° ì„¤ëª…ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nì´ íŒŒì´ì¬ í”„ë¡œì íŠ¸ëŠ” slurmì„ í†µí•´ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´, HPC í™˜ê²½ì—ì„œ ëª¨ë¸ì„ í•™ìŠµí•˜ê¸° ìœ„í•œ slurm ìŠ¤í¬ë¦½íŠ¸ `transformer.sh`ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.\n\n</br>\n\nìŠ¤í¬ë¦½íŠ¸ ì‘ì„±ì€ 2ê°€ì§€ ë²„ì „ìœ¼ë¡œ ë‚˜ë‰˜ì–´ ì†Œê°œí•©ë‹ˆë‹¤.\nê³„ì‚° ë…¸ë“œì— ì§„ì…í•œ í›„, enroot ê°€ìƒí™˜ê²½ì„ ì‚¬ìš©í•˜ì˜€ë‹¤ë©´ SLURM ì‘ì—… ìŠ¤ì¼€ì¥´ëŸ¬ë¥¼ í†µí•œ ìë™í™” ë°°ì¹˜ ì‘ì—…ì´ í•„ìš”í•˜ì§€ ì•Šê¸°ì—, í•„ìš”í•œ í™˜ê²½ê³¼ ëª¨ë“ˆë§Œ ë¡œë“œí•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\n```{bash}\n#| eval: false\n\necho \"start at:\" `date` # ì ‘ì†í•œ ë‚ ì§œ í‘œê¸°\necho \"node: $HOSTNAME\" # ì ‘ì†í•œ ë…¸ë“œ ë²ˆí˜¸ í‘œê¸°\necho \"jobid: $SLURM_JOB_ID\" # jobid í‘œê¸°\n\n# Load modules\nmodule load cuda/11.8\n\n# Train the transformer-based image captioning model\npython transformer.py\n```\n\ncondaë¥¼ í†µí•´ ê°€ìƒí™˜ê²½ ì‹¤í–‰ì‹œì¼°ë‹¤ë©´, ë…¸ë“œ ì§„ì…ì„ ìœ„í•œ ì…‹íŒ…ì´ ì¶”ê°€ë¡œ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— SBATCHë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.\n\n```{bash}\n#| eval: false\n\n#!/bin/bash\n#SBATCH --job-name=captioning\n#SBATCH --output=./output/training_captioning_%n_%j.out\n#SBATCH --error=./output/training_captioning_%n_%j.err\n#SBATCH --nodes=2\n#SBATCH --partition=gpu3\n#SBATCH --gres=gpu:4\n#SBATCH --cpus-per-task=16\n#SBATCH --mem=128G\n#SBATCH --time=24:00:00\n\necho \"start at:\" `date` # ì ‘ì†í•œ ë‚ ì§œ í‘œê¸°\necho \"node: $HOSTNAME\" # ì ‘ì†í•œ ë…¸ë“œ ë²ˆí˜¸ í‘œê¸°\necho \"jobid: $SLURM_JOB_ID\" # jobid í‘œê¸°\n\n# Load modules\nmodule load cuda/11.8\n\n# Train the transformer-based image captioning model\npython transformer.py\n```\n\nâœ” **`#SBATCH --job-name=captioning`**\njob-nameì„ captioningìœ¼ë¡œ ì§€ì •í•˜ì˜€ìŠµë‹ˆë‹¤.\n\nâœ” output íŒŒì¼ê³¼ error íŒŒì¼ì€ output í´ë”ì˜ training_captioningì´ë¼ëŠ” íŒŒì¼ëª…ìœ¼ë¡œ ì§€ì •í•˜ì˜€ìŠµë‹ˆë‹¤.\n\nâœ” **`#SBATCH --nodes=2`**\në³µì¡í•œ ì‘ì—…ì„ ìš”êµ¬í•˜ëŠ” í”„ë¡œì íŠ¸ì¸ ë§Œí¼, ì‹œê°„ì˜ íš¨ìœ¨ì„±ì„ ìœ„í•´ node 2ê°œë¥¼ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤. ì´ì— ë”°ë¼, node 2ê°œë¡œ í•˜ë‚˜ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë³‘ë ¬ ì»´í“¨íŒ…ì„ ì‹œí–‰í•©ë‹ˆë‹¤.\n\nâœ” **`#SBATCH --gres=gpu:4`**\ngpuëŠ” 4ëŒ€ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.\n\nâœ” **`module load cuda/11.8`**\nmoduleì€ cuda 11.8 versionì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.\n\nâœ” **`python transformer.py`**\n`transformer.py` íŒŒì¼ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.\n\n`sbatch transformer.sh`ë¥¼ í†µí•´ ì‘ì—…(job)ì„ í• ë‹¹í•˜ì˜€ìŠµë‹ˆë‹¤.\n\ní”„ë¡œì íŠ¸ì—ì„œ tqdm ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ì§„ì²™ë„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆê²Œ ì„¸íŒ…í•´ë‘ ì— ë”°ë¼, error íŒŒì¼ì—ì„œ ì§„ì²™ë„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![](./jpg/epoch.jpg)\n\nout íŒŒì¼ì—ì„œ í•™ìŠµëœ logë¥¼ í†µí•´, ì‹¤í–‰ ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.\n\nì•„ë˜ì˜ ê·¸ë¦¼ì— ëŒ€í•´ \"a shoe rack with some shoes and a dog sleeping on them\"ê³¼ ê°™ì€ captionì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n![](./jpg/COCO_val2014_000000000042.jpg)\n\n</br>\n\nì´ìƒìœ¼ë¡œ Captioning í”„ë¡œì íŠ¸ ì‹¤ìŠµì„ ì¢…ë£Œí•©ë‹ˆë‹¤."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","number-sections":false,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":["minty","r4ds.scss"],"author-meta":"hs.hwang","callout-appearance":"simple","fontsize":"1em","linestretch":1.5,"code-block-bg":true,"code-block-border-left":true,"title":"Image Captioning"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"index.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"documentclass":"scrreprt","title":"Image Captioning"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}